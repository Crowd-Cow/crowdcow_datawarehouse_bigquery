version: 2

sources:

  - name: iterable
    ##database: raw
    schema: raw_iterable
    tables:
      - name: journeys
      - name: events
        description: Iterable events for things like email sends, clicks, opens, etc

        columns:
          - name: _fivetran_id
            description: Unique ID automatically generated by Fivetran

          - name: email
            description: Email address associated with the event

          - name: campaign_id
            description: Campaign ID associated with the event

          - name: message_id
            description: Message ID

          - name: content_id
            description: Content ID

          - name: created_at
            description: Timestamp for when the record was created in Iterable

          - name: event_name
            description: Name of the event (e.g. email open, click, etc)

          - name: ip
            description: IP address associated with the event

          - name: message_bus_id
            description: Message bus ID

          - name: recipient_state
            description: System state of the event (e.g. Email bounced, unsubscribed, etc)

          - name: status
            description: Status of the event

          - name: unsub_source
            description: Source of the user unsubscribe

          - name: user_agent
            description: User agent associated with the event

          - name: user_agent_device
            description: Device associated with the event derived from the user agent

          - name: transactional_data
            description: Transactional data

          - name: additional_properties
            description: JSON object storing additional properties associated with the event

          - name: _fivetran_synced
            description: Timestamp of when the record was synced by Fivetran

          - name: is_custom_event
            description: Boolean indicating if the event is a custom event sent by Crowd Cow to Iterable

      - name: campaigns
        description: History of changes to a campaign in Iterable

        columns:
          - name: id
            description: Campaign ID

          - name: updated_at
            description: Timestamp for when the campaign record was updated

          - name: template_id
            description: Template ID

          - name: recurring_campaign_id
            description: Recurring campaign ID

          - name: campaign_state
            description: System state of the campaign (e.g. Ready, Finished, Draft, etc)

          - name: created_at
            description: Timestamp for when the campaign record was created in Iterable

          - name: created_by_user_id
            description: Iterable user that created the campaign

          - name: ended_at
            description: Timestamp for when the campaign ended

          - name: name
            description: Campaign name

          - name: send_size
            description: The number of emails sent for the campaign

          - name: type
            description: The type of campaign (e.g. Blast, Triggered, etc.)

          - name: _fivetran_synced
            description: Timestamp for when the record was synced by Fivetran

      - name: users
        description: History of changes to a user within Iterable

        columns:
          - name: email
            description: Email address of the user

          - name: updated_at
            description: Timestamp for when the user history record was updated in Iterable

          - name: first_name
            description: First name of the user

          - name: last_name
            description: Last name of the user

          - name: phone_number
            description: Phone number of the user

          - name: user_id
            description: User ID that ties back to the Crowd Cow `user_token`
          
          - name: signup_date
            description: User signup date

          - name: signup_source
            description: Source of the user signup

          - name: email_list_ids
            description: A list of email list IDs a user is part of

          - name: phone_number_carrier
            description: Phone number carrier of the user

          - name: phone_number_country_code_iso
            description: Phone number ISO country code value

          - name: phone_number_line_type
            description: Phone number line type

          - name: phone_number_updated_at
            description: Timestamp for when the phone number was updated

          - name: _fivetran_synced
            description: Timestamp for when the record was synced by Fivetran

          - name: additional_properties
            description: JSON object that stores additional properties about the user
            
      - name: users_emaillistids
        description: "Staging model for Iterable user lists"

        columns:
          - name: user_email
            description: "Email address of the user"

          - name: updated_at_utc
            description: "Timestamp for when the user history record was updated in Iterable"

          - name: user_token
            description: "User token that ties back to the Crowd Cow `user_token`"

          - name: list_id
            description: "A list of email list IDs a user is part of"

      - name: campaigns_listids
      - name: iterable_lists 
