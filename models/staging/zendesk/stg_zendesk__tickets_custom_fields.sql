with 

source as ( select * from {{ source('zendesk', 'tickets_custom_fields') }} )

 SELECT 
  __tickets_panoply_id as __tickets_panoply_id,
  MAX(CASE WHEN custom_fields_id = 114097404133 THEN value END) AS order_errors,
  MAX(CASE WHEN custom_fields_id = 360010596793 THEN value END) AS custom_type,
  MAX(CASE WHEN custom_fields_id = 4416003056923 THEN value END) AS blastable_potential_template,
  MAX(CASE WHEN custom_fields_id = 114099323633 THEN value END) AS order_id,
  MAX(CASE WHEN custom_fields_id = 114102682133 THEN value END) AS automation_type,
  MAX(CASE WHEN custom_fields_id = 76139767 THEN value END) AS subject,
  MAX(CASE WHEN custom_fields_id = 360014531634 THEN value END) AS filter_for_productivity,
  MAX(CASE WHEN custom_fields_id = 18881275336859 THEN value END) AS issue_triage,
  MAX(CASE WHEN custom_fields_id = 18979049824923 THEN value END) AS askstylo_issue_category,
  MAX(CASE WHEN custom_fields_id = 360040205754 THEN value END) AS issue_category,
  MAX(CASE WHEN custom_fields_id = 1260804060649 THEN value END) AS cow_cash_reason,
  MAX(CASE WHEN custom_fields_id = 4412885942427 THEN value END) AS ticket_form_name,
  MAX(CASE WHEN custom_fields_id = 80386068 THEN value END) AS cust_email,
  MAX(CASE WHEN custom_fields_id = 4412896710555 THEN value END) AS ticket_form_reason,
  MAX(CASE WHEN custom_fields_id = 360049109234 THEN value END) AS ai_category,
  MAX(CASE WHEN custom_fields_id = 76139827 THEN value END) AS ticket_type,
  MAX(CASE WHEN custom_fields_id = 76139867 THEN value END) AS custom_group,
  MAX(CASE WHEN custom_fields_id = 76139807 THEN value END) AS status,
  MAX(CASE WHEN custom_fields_id = 76139847 THEN value END) AS priority,
  MAX(CASE WHEN custom_fields_id = 9327123588635 THEN value END) AS ticket_status,
  MAX(CASE WHEN custom_fields_id = 18952211832475 THEN value END) AS stylo_urgency_change,
  MAX(CASE WHEN custom_fields_id = 18952199864731 THEN value END) AS stylo_frustration_options,
  MAX(CASE WHEN custom_fields_id = 18952212081947 THEN value END) AS stylo_assist_actions_taken,
  MAX(CASE WHEN custom_fields_id = 18952225060379 THEN value END) AS stylo_frustration_change,
  MAX(CASE WHEN custom_fields_id = 18952199834523 THEN value END) AS stylo_urgency_options,
  MAX(CASE WHEN custom_fields_id = 76139887 THEN value END) AS assignee,
  MAX(CASE WHEN custom_fields_id = 21583580953115 THEN value END) AS reason_for_reach_out_text_box,
  MAX(CASE WHEN custom_fields_id = 21583431879323 THEN value END) AS form_inquiry_category,
  MAX(CASE WHEN custom_fields_id = 21583510870555 THEN value END) AS form_website_catagories,
  MAX(CASE WHEN custom_fields_id = 21583521341211 THEN value END) AS form_delivery_catagories,
  MAX(CASE WHEN custom_fields_id = 21583547923611 THEN value END) AS form_order_issue_catagories,
  MAX(CASE WHEN custom_fields_id = 21583567231643 THEN value END) AS form_product_quality_issue_catagories,
  MAX(CASE WHEN custom_fields_id = 4412892701723 THEN value END) AS ticket_form_order_number,
  MAX(CASE WHEN custom_fields_id = 76139787 THEN value END) AS description,
  MAX(CASE WHEN custom_fields_id = 17049133351195 THEN value END) AS name_of_product_with_quality_issue,
  MAX(CASE WHEN custom_fields_id = 360000770534 THEN value END) AS total_time_spent_sec,
  MAX(CASE WHEN custom_fields_id = 360000770554 THEN value END) AS time_spent_last_update_sec,
  MAX(CASE WHEN custom_fields_id = 1260817382530 THEN value END) AS total_credit_refund_given,
  MAX(CASE WHEN custom_fields_id = 18952197504155 THEN value END) AS stylo_deescalate,
  MAX(CASE WHEN custom_fields_id = 24556565715099 THEN value END) AS stylo_starting_frustration,
  MAX(CASE WHEN custom_fields_id = 18952211616027 THEN value END) AS stylo_frustration,
  MAX(CASE WHEN custom_fields_id = 18952188547099 THEN value END) AS stylo_peak_frustration,
  MAX(CASE WHEN custom_fields_id = 18952225192603 THEN value END) AS stylo_peak_delight,
  MAX(CASE WHEN custom_fields_id = 24888564882331 THEN value END) AS stylo_starting_delight,
  MAX(CASE WHEN custom_fields_id = 24888563346459 THEN value END) AS stylo_starting_urgency,
  MAX(CASE WHEN custom_fields_id = 18952215643035 THEN value END) AS stylo_urgency,
  MAX(CASE WHEN custom_fields_id = 18952225293851 THEN value END) AS stylo_delight_change_numeric,
  MAX(CASE WHEN custom_fields_id = 18952200084507 THEN value END) AS stylo_frustration_change_numeric,
  MAX(CASE WHEN custom_fields_id = 18952224970011 THEN value END) AS stylo_delight,
  MAX(CASE WHEN custom_fields_id = 18952225173659 THEN value END) AS stylo_peak_urgency,
  MAX(CASE WHEN custom_fields_id = 18952199786907 THEN value END) AS stylo_p_csat,
  MAX(CASE WHEN custom_fields_id = 18952188670235 THEN value END) AS stylo_urgency_change_numeric,
  MAX(CASE WHEN custom_fields_id = 18952188621339 THEN value END) AS stylo_peak_agent_frustration,
  MAX(CASE WHEN custom_fields_id = 24556592790299 THEN value END) AS stylo_agent_frustration
FROM source
group by 1 

